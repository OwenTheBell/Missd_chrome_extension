<html>
	<script>
		function saveState(){
			chrome.windows.getAll({'populate' : true}, function(windows){
				var req = '<?xml version="1.0"?>\
				<methodCall>\
				<methodName>MISS.addRecord</methodName>\
				<params>\
				<param>\
				<value><string>savedState</string></value>\
				</param>\
				<param>\
				<value><string>stuff</string></value>\
				</param>\
				<param>\
				<value><string><![CDATA[<?xml version="1.0"?>/<browserState>/
				<window>/
					<tab url="http://www.blah.com">/
						<historyItem url="http://www.google.com"/>/
					</tab>/
					<tab url="http://www.facebook.com" selected="true"/>//
				</window>/
				</browserState></string></value>\
				</param>\
				<param>\
				<value><boolean>1</boolean></value>\
				</param>\
				<param>\
				<value><array><data></data></array></value>\
				</param>\
				</params>\
				</methodCall>';
				xmlhttp = new XMLHttpRequest();
				xmlhttp.open('POST', 'http://localhost:8198',true);
				xmlhttp.send(req);
				});
		}
		
		function loadState(){
			var req = '<?xml version="1.0"?>\
			<methodCall>\
			<methodName>MISS.getRecord</methodName>\
			<params>\
			<param>\
				<value><string>ME</string></value>\
			</param>\
			<param>\
				<value><string>savedState</string></value>\
			</param>\
			<param>\
				<value><string>stuff</string></value>\
			</param>\
			</params>\
			</methodCall>';
			
			xmlhttp = new XMLHttpRequest();
			xmlhttp.open('POST', 'http://localhost:8198',true);
			xmlhttp.send(req);
			xmlhttp.onreadystatechange=function()
  			{
  				if (xmlhttp.readyState==4 && xmlhttp.status==200)
    				{
    					console.log(xmlhttp.responseXML);
    				}
  			}

			
		}
	</script>
</html>
